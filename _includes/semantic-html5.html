<!-- HTML5 語義化標記優化 -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": "{{ site.url }}#website",
      "url": "{{ site.url }}",
      "name": "{{ site.title }}",
      "description": "{{ site.description }}",
      "publisher": {
        "@id": "{{ site.url }}#organization"
      },
      "potentialAction": [
        {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "{{ site.url }}/rooms.html?q={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        }
      ],
      "inLanguage": "zh-TW"
    },
    {
      "@type": "WebPage",
      "@id": "{{ page.url | prepend: site.url }}#webpage",
      "url": "{{ page.url | prepend: site.url }}",
      "name": "{{ page.title | default: site.title }}",
      "isPartOf": {
        "@id": "{{ site.url }}#website"
      },
      "about": {
        "@id": "{{ site.url }}#organization"
      },
      "datePublished": "{{ page.date | default: site.time | date_to_xmlschema }}",
      "dateModified": "{{ page.last_modified_at | default: site.time | date_to_xmlschema }}",
      "breadcrumb": {
        "@id": "{{ page.url | prepend: site.url }}#breadcrumb"
      },
      "inLanguage": "zh-TW",
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": ["{{ page.url | prepend: site.url }}"]
        }
      ]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "{{ page.url | prepend: site.url }}#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "首頁",
          "item": "{{ site.url }}"
        }
        {% if page.collection == "rooms" %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "name": "房型展示",
          "item": "{{ site.url }}/rooms.html"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page.title }}",
          "item": "{{ page.url | prepend: site.url }}"
        }
        {% elsif page.collection == "infos" %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "name": "園區資訊",
          "item": "{{ site.url }}/"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page.title }}",
          "item": "{{ page.url | prepend: site.url }}"
        }
        {% elsif page.title and page.url != "/" %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "name": "{{ page.title }}",
          "item": "{{ page.url | prepend: site.url }}"
        }
        {% endif %}
      ]
    }
  ]
}
</script>

<!-- 頁面特定微標記 -->
{% if page.collection == "rooms" %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "{{ page.title }}",
  "description": "{{ page.content | strip_html | truncate: 160 }}",
  "image": "{{ page.main_image | prepend: site.url }}",
  "brand": {
    "@type": "Brand",
    "name": "{{ site.title }}"
  },
  "offers": {
    "@type": "Offer",
    "price": "{{ page.weekday_price }}",
    "priceCurrency": "TWD",
    "availability": "https://schema.org/InStock",
    "priceRange": "NT${{ page.weekday_price }}-NT${{ page.holiday_price }}",
    "seller": {
      "@type": "Organization",
      "name": "{{ site.title }}",
      "url": "{{ site.url }}"
    },
    "url": "https://traiwan.com/official/booking.php?id=misstravel"
  },
  "category": "住宿",
  "additionalProperty": [
    {
      "@type": "PropertyValue",
      "name": "平日價格",
      "value": "NT${{ page.weekday_price }}"
    },
    {
      "@type": "PropertyValue", 
      "name": "假日價格",
      "value": "NT${{ page.holiday_price }}"
    },
    {
      "@type": "PropertyValue",
      "name": "標準價格",
      "value": "NT${{ page.standard_price }}"
    }
  ]
}
</script>
{% endif %}