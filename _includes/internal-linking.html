<!-- Internal Linking Enhancement for SEO -->

{% if page.collection == "rooms" %}
<!-- Related Rooms Section -->
<section class="related-content">
  <div class="inner">
    <header class="major">
      <h2>其他住宿選擇</h2>
    </header>
    <div class="row">
      {% assign current_page_url = page.url %}
      {% assign related_rooms = site.rooms | where_exp: "room", "room.url != current_page_url" | sample: 3 %}
      {% for room in related_rooms %}
      <div class="col-4 col-12-medium">
        <article class="related-room">
          <a href="{{ room.url | relative_url }}" class="image fit">
            <img src="{{ site.baseurl }}/assets/images/rooms/{{ room.title }}/{{ room.title }}_1.jpg" 
                 alt="{{ room.title }} - {{ room.description | strip_html | truncate: 60 }}" 
                 loading="lazy">
          </a>
          <h3><a href="{{ room.url | relative_url }}">{{ room.title }}</a></h3>
          <p>平日價格：NT$ {{ room.weekday_price }}</p>
          <ul class="actions">
            <li><a href="{{ room.url | relative_url }}" class="button small">了解更多</a></li>
          </ul>
        </article>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- Quick Links Navigation -->
<nav class="quick-links" role="navigation" aria-label="快速連結">
  <h2 class="sr-only">快速連結</h2>
  <ul>
    {% if page.url != "/" %}
    <li><a href="{{ site.baseurl }}/" title="返回首頁">首頁</a></li>
    {% endif %}
    
    {% for link in site.infos %}
    {% if link.url != page.url %}
    <li><a href="{{ link.url | relative_url }}" title="{{ link.description | default: link.title }}">{{ link.title }}</a></li>
    {% endif %}
    {% endfor %}
    
    {% unless page.collection == "rooms" %}
    <li><a href="{{ site.baseurl }}/landing.html" title="查看所有住宿選擇">住宿選擇</a></li>
    {% endunless %}
  </ul>
</nav>

<!-- Contextual Links Based on Content -->
{% if page.content contains "溫泉" or page.content contains "泡湯" %}
<aside class="contextual-links">
  <h3>相關資訊</h3>
  <p>附近有著名的泰安溫泉，<a href="{{ site.baseurl }}/info/map">查看地圖</a>了解詳細位置。</p>
</aside>
{% endif %}

{% if page.content contains "預訂" or page.content contains "訂房" %}
<aside class="contextual-links">
  <h3>預訂資訊</h3>
  <p>準備好預訂了嗎？請<a href="{{ site.baseurl }}/info/contact">聯絡我們</a>或查看<a href="{{ site.baseurl }}/info/rules">訂房須知</a>。</p>
</aside>
{% endif %}

<!-- Structured Navigation Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SiteNavigationElement",
  "name": "主要導航",
  "url": "{{ site.url }}{{ page.url }}",
  "hasPart": [
    {
      "@type": "SiteNavigationElement",
      "name": "首頁",
      "url": "{{ site.url }}/"
    },
    {
      "@type": "SiteNavigationElement", 
      "name": "住宿選擇",
      "url": "{{ site.url }}/landing.html"
    },
    {% for info in site.infos %}
    {
      "@type": "SiteNavigationElement",
      "name": "{{ info.title }}",
      "url": "{{ site.url }}{{ info.url }}"
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>

<style>
.related-content {
  margin-top: 3em;
  padding-top: 3em;
  border-top: 1px solid #e0e0e0;
}

.related-room {
  margin-bottom: 2em;
}

.related-room .image {
  margin-bottom: 1em;
}

.quick-links {
  margin: 2em 0;
  padding: 1em;
  background: #f5f5f5;
  border-radius: 0.5em;
}

.quick-links ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-wrap: wrap;
  gap: 1em;
}

.quick-links li {
  margin: 0;
}

.contextual-links {
  margin: 2em 0;
  padding: 1.5em;
  background: #e8f4f8;
  border-left: 4px solid #2196F3;
  border-radius: 0.25em;
}

.contextual-links h3 {
  margin-top: 0;
  color: #1976D2;
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0,0,0,0);
  white-space: nowrap;
  border: 0;
}

@media screen and (max-width: 736px) {
  .quick-links ul {
    flex-direction: column;
  }
}
</style>